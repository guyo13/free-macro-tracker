<html>
    <title>FMT DB design and TODO</title>
    <head>
        <style>
            body p {font-size: 20px;}
            .major {color: red; font-weight: bolder;}
            .med {color: orange; font-weight: bold;}
            .minor {color:fuchsia;}
        </style>
    </head>
    <body>
        <h1>Structure of Data</h1>
        <h2>Profile Object Store</h2>
        <p>
            <b>KEY PATH = "profile_id" autoIncrement==false</b><br/>
            profile_id - int <br/>
            name - String <br/>
            bodyWeight - Number <br/>
            bodyWeightUnits - String (either "Kg" or "Lbs") <br/>
            bodyWeightKg - Number <br/>
            height - Number <br/>
            heightUnits - String (either "Cm" or "Inch") <br/>
            heightCm - Number <br/>
            <span class="minor">age - Number //TODO change to and validate as int</span> <br/>
            sex - String (either "Male" or "Female") <br/>
            bodyfat - float (0-100) <br/>
            bodyfatReal - float (0-1) <br/>
            activityLevel - String ("Sedentary", "Light", "Moderate", "High", "Very High", "Custom") <br/>
            activityMultiplier - float <br/>
            formula - String ("Katch-McArdle" or "Mifflin-St Jeor") <br/>
            bmr - Number <br/>
            tdee - Number <br/>
            macroSplit - Object ({"Calories":Number,"Protein":Number,"Carbohydrate":Number,"Fat":Number})<br/>
            lastModified - Date <br/>
            tzMinutes - int <br/>
            <span class="minor">//TODO - microScplit</span>
        </p>
        

        <h2>Mass Units Object Store</h2>
        <p>
            <b>KEY PATH = "name"</b> <br/>
            name - String <br/>
            value_in_grams - float <br/>
            description - String <br/>
        </p>
        <h2>Nutrients Object Store</h2>
        <p>
            <b>KEY PATH = "name" // TODO make category part of the key path!</b> <br/>
            name - String <br/>
            category - String  <br/>
            default_mass_unit - String (logically references a Mass Unit "name") <br/>
            help - String <br/>
        </p>
        <h2>Foods Object Store</h2>
        <p>
            <b>KEY PATH = "food_id" autoIncrement = true</b> <br/>
            food_id - int <br/>
            foodName - String <br/>
            foodBrand - String <br/>
            created - Date <br/>
            lastModified - Date <br/>
            tzMinutes - int <br/>
            referenceWeight - Number <br/>
            weightUnits - String (logically references a Mass Unit "name") <br/>
            nutritionalValue - Object ({calories-Number,proteins-Number,carbohydrates-Number,fats-Number,additionalNutrients-Object}) <br/>
                                additionalNutrients - { "NutrientCategory1": [{"name":String, "mass":Number, "unit":String}, ... , {...}], ... , "NutrientCategoryN": [{...}, ... ,{...}] } <br/>
        </p>
        
        <h2>Recipes Object Store</h2>
        <p>
            KEY PATH = "recipe_id" autoIncrement = true <br/>
            recipe_id - int <br/>
            recipe_name - String <br/>
            created - Date <br/>
            lastModified - Date <br/>
            tzMinutes - int <br/>
            referenceWeight - Number <br/>
            weightUnits - String (logically references a Mass Unit "name") <br/>
            foodMakeup - Array of Objects** <br/>
            nutritionalValue - Object (see above) <br/>
            **foodMakeup - {food_id,foodName,foodBrand,weight,weightUnits} <br/>
        </p>
        <h2>Meal Entries Object Store</h2>
        <p>
            KEY PATH = ["profile_id", "entry_id"]  || ["profile_id", [year, month, day], "entry_id"] //TODO <br/>
            entry_id - int <br/>
            profile_id - int (logically references the profile id from profile store) <br/>
            year - int <br/>
            month - int (0-11) <br/>
            day - int <br/>
            mealName - String <br/>
            created - Date <br/>
            lastModified - Date <br/>
            tzMinutes - int <br/>
            consumable_id - int <br/>
            consumableName - String <br/>
            foodBrand - String <br/>
            is_recipe - boolean <br/>
            weight - Number <br/>
            weightUnits - String (logically references a Mass Unit "name") <br/>
            nutritionalValue - Object (See above) <br/>
        </p>

        <h2>User Settings Object Store - TODO</h2>
        <p>
            KEY PATH = profile_id autoIncrement=false <br/>
            profile_id - int <br/>
            settings - Object (reduced version of fmtAppInstance) <br/>
        </p>

    <h1>DB OPERATIONS:</h1>
        <h2>Profiles:</h2>
        <p>
            <del>Read all profiles (getAll)</del> <br/>
            <del>Query profile by profile ID</del> <br/>
            <b>Update Profile - NEED TO SEPARATE FROM UI</b> <br/>
            <b>Create new Profile - NEED TO SEPARATE FROM UI</b> <br/>
        </p>
        <h2>Mass Units:</h2>
        <p>
            <del>Read all mass units (getAll+cursor)</del> <br/>
            <del>Query mass unit by category and name</del> <br/>
            <del>Create new mass unit</del> <br/>
            <del>Update mass unit</del> <br/>
            <del>Delete mass unit</del> <br/>
        </p>
        <h2>Foods:</h2>
        <p>
            <del>Query food by food ID</del> <br/>
            Query food by food name <br/>
            Query food by food brand <br/>
            Query food by nutrient content (maybe impl outside of db) <br/>
            <del>Add new food</del> <br/>
            <del>Update food</del> <br/>
            <del>Delete food</del> <br/>
            <del>Read all foods (openCursor+getAll)</del> <br/>
        </p>
        <h2>Recipes:</h2>
        <p>
            Query recipe by recipe ID <br/>
            Query recipe by recipe name <br/>
            Query recipe by food name <br/>
            Query recipe by nutrient content (maybe impl outside of db) <br/>
            Add new recipe <br/>
            Update recipe <br/>
            Delete recipe <br/>
            Read all recipes (openCursor) <br/>
        </p>
        
        <h2>Nutrients:</h2>
        <p>
            <b>Query nutrient by category and name - NEED TO ADD NUTRIENT CATEGORY AS KP</b> <br/>
            <del>Read all nutrients (getAll+cursor)</del> <br/>
            <del>Add new nutrient</del> <br/>
            <del>Update nutrient</del> <br/>
            <b>Delete nutrient - NEED TO ADD NUTRIENT CATEGORY AS KP</b> <br/>
        </p>
        <h2>User settings:</h2>
        <p>
            Query by profile Id <br/>
            Add new <br/>
            Update <br/>
            Delete <br/>
        </p>
        <h2>Meal Entries:</h2>
        <p>
            Query all by profile id (cursor) <br/>
            Query by profile id and entry id <br/>
            Query by profile_id and [year, month, day] (cursor) <br/>
            Create, update, delete <br/>
        </p>
    </body>
</html>